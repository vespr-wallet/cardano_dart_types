// ignore_for_file: unused_local_variable, constant_identifier_names, dead_code, avoid_print

import "package:cardano_dart_types/cardano_dart_types.dart";

void main() async {
  const minswap_instant_tx =
      "84a6008482582069f647781a51876c03bce5915cafc494f45456dec10d2cf7d6a730dcd338ce7101825820b187362541bcede39962010795394b2d6a86b943b2bd8db3ed64044e199b316701825820b187362541bcede39962010795394b2d6a86b943b2bd8db3ed64044e199b316702825820fd67551fa18fc075a8687cb2621378ccbdf55d66b10c492753d38e29e491673903018383583911a65ca58a4e9c755fa830173d2a5caed458ac0c73f97db7faae2e7e3b52563c5410bff6a0d43ccebb7c37e1f69f5eb260552521adff33b9c21a0cef1a665820a73e566454372ae65eb101d0f14a6e507fdb9593160269b476f595f7658dc34982583901ed49d9adbd06592290b9a16032375d6b79d4df760cad0d9bca9555fc4199f66b16ce9eb5849ed96473face025b2e9bcbdf1e352ad43629811abff58df482583901ed49d9adbd06592290b9a16032375d6b79d4df760cad0d9bca9555fc4199f66b16ce9eb5849ed96473face025b2e9bcbdf1e352ad4362981821a003630d0ad581c0e14267a8020229adc0184dd25fa3174c3f7d6caadcb4425c70e7c04a14a756e736967303131313801581c160a880d9fc45380737cb7e57ff859763230aab28b3ef6a84007bfcca1444d4952411864581c16fdd33c86af604e837ae57d79d5f0f1156406086db5f16afb3fcf51a14544474f4c441a05f5e100581c1f362a4df39f451401e44fee30f27eb39712d66aae375f539be94ed6a14c546865496c6961643238303401581c29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c6a1434d494e1a00701aae581c2eeb39204c3d104b40ec56bfd612bb1067fdea45de15f3a8aad9db71a14d4d616769634b6f6e673235303201581c682fe60c9918842b3323c43b5144bc3d52a23bd2fb81345560d73f63a1444e45574d1a004c4b40581ca0028f350aaabe0545fdcb56b039bfb08e4bb4d8c4d7c3c7d481c235a145484f534b591a000f4240581caf2e27f580f7f08e93190a81f72462f153026d06450924726645891ba144445249501a7de7b663581cb6a7467ea1deb012808ef4e87b5ff371e85f7142d7b356a40d9b42a0a1581e436f726e75636f70696173205b76696120436861696e506f72742e696f5d1a004c4b40581cc68307e7ca850513507f1498862a57c7f4fae7ba8e84b8bc074093a9a14444494253191388581cdfc825363afcdff0f5ec3171f0a29b1d345d271714aa9b2a552b6bbfa148416e74546f6b656e1832581ce4214b7cce62ac6fbba385d164df48e157eae5863521b4b67ca71d86a158206aa2153e1ae896a95539c9d62f76cedcdabdcdf144e564b8955f609d660cf6a21a0211e121021a000355c5031a0557e4ee075820b64602eebf602e8bbce198e2a1d6bbb2a109ae87fa5316135d217110d6d946490b58205109fa2ce7968f8cc211dba68e338a4b620db1a35108aad7ff6b953ad86890dba1049fd8799fd8799fd8799f581ced49d9adbd06592290b9a16032375d6b79d4df760cad0d9bca9555fcffd8799fd8799fd8799f581c4199f66b16ce9eb5849ed96473face025b2e9bcbdf1e352ad4362981ffffffffd8799fd8799f581ced49d9adbd06592290b9a16032375d6b79d4df760cad0d9bca9555fcffd8799fd8799fd8799f581c4199f66b16ce9eb5849ed96473face025b2e9bcbdf1e352ad4362981ffffffffd87a80d8799fd8799f581c29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c6434d494eff1a84369796ff1a001e76a61a001e8480fffff5a11902a2a1636d736781781c4d696e737761703a205377617020457861637420496e204f72646572";

  // slippage 11%
  const minswap_insant_w_slippage_tx =
      "84a6008482582069f647781a51876c03bce5915cafc494f45456dec10d2cf7d6a730dcd338ce7101825820b187362541bcede39962010795394b2d6a86b943b2bd8db3ed64044e199b316701825820b187362541bcede39962010795394b2d6a86b943b2bd8db3ed64044e199b316702825820fd67551fa18fc075a8687cb2621378ccbdf55d66b10c492753d38e29e491673903018383583911a65ca58a4e9c755fa830173d2a5caed458ac0c73f97db7faae2e7e3b52563c5410bff6a0d43ccebb7c37e1f69f5eb260552521adff33b9c21a0cef1a6658207f9e179df0bfff519070142123c07a30fc3e0205fb3ff3abe0733dab110b004282583901ed49d9adbd06592290b9a16032375d6b79d4df760cad0d9bca9555fc4199f66b16ce9eb5849ed96473face025b2e9bcbdf1e352ad43629811abff58df482583901ed49d9adbd06592290b9a16032375d6b79d4df760cad0d9bca9555fc4199f66b16ce9eb5849ed96473face025b2e9bcbdf1e352ad4362981821a003630d0ad581c0e14267a8020229adc0184dd25fa3174c3f7d6caadcb4425c70e7c04a14a756e736967303131313801581c160a880d9fc45380737cb7e57ff859763230aab28b3ef6a84007bfcca1444d4952411864581c16fdd33c86af604e837ae57d79d5f0f1156406086db5f16afb3fcf51a14544474f4c441a05f5e100581c1f362a4df39f451401e44fee30f27eb39712d66aae375f539be94ed6a14c546865496c6961643238303401581c29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c6a1434d494e1a00701aae581c2eeb39204c3d104b40ec56bfd612bb1067fdea45de15f3a8aad9db71a14d4d616769634b6f6e673235303201581c682fe60c9918842b3323c43b5144bc3d52a23bd2fb81345560d73f63a1444e45574d1a004c4b40581ca0028f350aaabe0545fdcb56b039bfb08e4bb4d8c4d7c3c7d481c235a145484f534b591a000f4240581caf2e27f580f7f08e93190a81f72462f153026d06450924726645891ba144445249501a7de7b663581cb6a7467ea1deb012808ef4e87b5ff371e85f7142d7b356a40d9b42a0a1581e436f726e75636f70696173205b76696120436861696e506f72742e696f5d1a004c4b40581cc68307e7ca850513507f1498862a57c7f4fae7ba8e84b8bc074093a9a14444494253191388581cdfc825363afcdff0f5ec3171f0a29b1d345d271714aa9b2a552b6bbfa148416e74546f6b656e1832581ce4214b7cce62ac6fbba385d164df48e157eae5863521b4b67ca71d86a158206aa2153e1ae896a95539c9d62f76cedcdabdcdf144e564b8955f609d660cf6a21a0211e121021a000355c5031a0557e604075820b64602eebf602e8bbce198e2a1d6bbb2a109ae87fa5316135d217110d6d946490b5820febbacf86d8bb158bad0f6dcd492586a4c2fccb874341c7cefc4a32141abbf3da1049fd8799fd8799fd8799f581ced49d9adbd06592290b9a16032375d6b79d4df760cad0d9bca9555fcffd8799fd8799fd8799f581c4199f66b16ce9eb5849ed96473face025b2e9bcbdf1e352ad4362981ffffffffd8799fd8799f581ced49d9adbd06592290b9a16032375d6b79d4df760cad0d9bca9555fcffd8799fd8799fd8799f581c4199f66b16ce9eb5849ed96473face025b2e9bcbdf1e352ad4362981ffffffffd87a80d8799fd8799f581c29d222ce763455e3d7a09a665ce554f00ac89d2e99a1a83d267170c6434d494eff1a77b4d99dff1a001e76a61a001e8480fffff5a11902a2a1636d736781781c4d696e737761703a205377617020457861637420496e204f72646572";

  const selectedTx = minswap_insant_w_slippage_tx;

  final tx = CardanoTransaction.deserializeFromHex(selectedTx);
  final txWitnessCbor = (cborDecode(selectedTx.hexDecode()) as CborList)[1] as CborMap;
  final txDatumCbor = txWitnessCbor[const CborSmallInt(4)]!;
  print("cbor datum: ${txDatumCbor.uint8ListEncode().hexEncode()}");
  print(txDatumCbor.toJsonV2(prettyPrint: true));

  final datum = PlutusData.deserialize(txDatumCbor);
  print(datum.toJson(prettyPrint: true));

  return;

  print(tx.toJson(prettyPrint: true));

  return;
  // print("e5b9b8e8bf90e79a84e6b586e69e9c".hexToUtf8());
  // return;
  // const datum =
  //     "d8799fd8799fd8799f581c353b8bc29a15603f0b73eac44653d1bd944d92e0e0dcd5eb185164a2ffd8799fd8799fd8799f581cda22c532206a75a628778eebaf63826f9d93fbe9b4ac69a7f8e4cd78ffffffffd8799fd8799f581c353b8bc29a15603f0b73eac44653d1bd944d92e0e0dcd5eb185164a2ffd8799fd8799fd8799f581cda22c532206a75a628778eebaf63826f9d93fbe9b4ac69a7f8e4cd78ffffffffd87a80d8799fd8799f581cdda5fdb1002f7389b33e036b6afee82a8189becb6cba852e8b79b4fb480014df1047454e53ff1a0006517aff1a001e84801a001e8480ff";
  const datum2 =
      "d8799f581c86ae9eebd8b97944a45201e4aec1330a72291af2d071644bba015959d8799fd8799fd8799f4040ffd8799f581c9abf0afd2f236a19f2842d502d0450cbcd9c79f123a9708f96fd9b9644454e4353ffff1b00000186f7381c180000ffff";
  final cborDatum = cborDecode(datum2.hexDecode());
  // print(cborDatum.toJson());
  // print(cborDatum.toJsonV2(prettyPrint: true));
  final data = PlutusData.deserialize(cborDatum);
  print(data.toJson(prettyPrint: true));
  // print(blake2bHash256(datum.hexDecode()).hexEncode()); // correct
  // print(data.blacke2bHash()?.hexEncode()); // wrong

  final addr = CardanoAddress.fromBech32OrBase58(
      "addr_test1qq6nhz7zng2kq0ctw04vg3jn6x7egnvjursde40trpgkfgk6ytznygr2wknzsauwawhk8qn0nkflh6d54356078ye4uqwau0ts");

  print(addr.addressType);
  print(addr.credentials);

  // const moonblob = "d87983a94442656c7446507572706c65446e616d654f4d6f6f6e20426c6f6220233332313945436f6c6f7246507572706c65454c6576656c4131455368696e794546616c73654566696c657381a3437372635835697066733a2f2f516d5437584b42315462683647555452525978415763654a7138665273314e674a6d79316d646e5467655a594737446e616d654f4d6f6f6e20426c6f62202333323139496d656469615479706549696d6167652f706e6745696d6167655835697066733a2f2f516d5437584b42315462683647555452525978415763654a7138665273314e674a6d79316d646e5467655a594737496d656469615479706549696d6167652f706e674a4261636b67726f756e644a4465657020537061636501d879860181581c3982842a6d5056a88db98103036cf958106f49eed7ff33b0c022d431d87a80581ca097df4102d7efd9ca6c5a3e508df50b5a8014193ba153d563a26584d87a80d87a80";
  // print(PlutusData.deserialize(moonblob.hexToCbor()).toJson(prettyPrint: true));
  // print(cborDatum.toJsonV2(prettyPrint: true));
}
